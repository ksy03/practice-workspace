import{a as oe,e as Be,f as F,g as Fe,h as Ke,j as wt,k as $e,l as de,n as ue}from"./chunks/chunk-VAN5TICPjs.js";import{a as Ue}from"./chunks/chunk-CSFUGYG4js.js";import{d as Oe,i as De,l as v,n as z,o as O,p as ze,q as ye,s as Ne}from"./chunks/chunk-2KAW52SRjs.js";import{a as $}from"./chunks/chunk-SY4NTXA7js.js";import{a as j,b as Ae,d as Rt,e as B,f as Y,g as Pe,h as We}from"./chunks/chunk-XJ5VWOPVjs.js";var qe=Rt((er,Ze)=>{"use strict";var V=new WeakMap,he=new WeakMap,ne=new WeakMap,Ge=Symbol("anyProducer"),Ve=Promise.resolve(),fe=Symbol("listenerAdded"),pe=Symbol("listenerRemoved"),xe=!1;function J(n){if(typeof n!="string"&&typeof n!="symbol")throw new TypeError("eventName must be a string or a symbol")}function me(n){if(typeof n!="function")throw new TypeError("listener must be a function")}function Q(n,r){let e=he.get(n);return e.has(r)||e.set(r,new Set),e.get(r)}function le(n,r){let e=typeof r=="string"||typeof r=="symbol"?r:Ge,t=ne.get(n);return t.has(e)||t.set(e,new Set),t.get(e)}function It(n,r,e){let t=ne.get(n);if(t.has(r))for(let o of t.get(r))o.enqueue(e);if(t.has(Ge)){let o=Promise.all([r,e]);for(let l of t.get(Ge))l.enqueue(o)}}function je(n,r){r=Array.isArray(r)?r:[r];let e=!1,t=()=>{},o=[],l={enqueue(a){o.push(a),t()},finish(){e=!0,t()}};for(let a of r)le(n,a).add(l);return{next(){return Y(this,null,function*(){return o?o.length===0?e?(o=void 0,this.next()):(yield new Promise(a=>{t=a}),this.next()):{done:!1,value:yield o.shift()}:{done:!0}})},return(d){return Y(this,arguments,function*(a){o=void 0;for(let s of r)le(n,s).delete(l);return t(),arguments.length>0?{done:!0,value:yield a}:{done:!0}})},[Symbol.asyncIterator](){return this}}}function Ye(n){if(n===void 0)return Xe;if(!Array.isArray(n))throw new TypeError("`methodNames` must be an array of strings");for(let r of n)if(!Xe.includes(r))throw typeof r!="string"?new TypeError("`methodNames` element must be a string"):new Error(`${r} is not Emittery method`);return n}var _e=n=>n===fe||n===pe,U=class{static mixin(r,e){return e=Ye(e),t=>{if(typeof t!="function")throw new TypeError("`target` must be function");for(let i of e)if(t.prototype[i]!==void 0)throw new Error(`The property \`${i}\` already exists on \`target\``);function o(){return Object.defineProperty(this,r,{enumerable:!1,value:new U}),this[r]}Object.defineProperty(t.prototype,r,{enumerable:!1,get:o});let l=i=>function(...a){return this[r][i](...a)};for(let i of e)Object.defineProperty(t.prototype,i,{enumerable:!1,value:l(i)});return t}}static get isDebugEnabled(){if(typeof process!="object")return xe;let{env:r}=process||{env:{}};return r.DEBUG==="emittery"||r.DEBUG==="*"||xe}static set isDebugEnabled(r){xe=r}constructor(r={}){V.set(this,new Set),he.set(this,new Map),ne.set(this,new Map),this.debug=r.debug||{},this.debug.enabled===void 0&&(this.debug.enabled=!1),this.debug.logger||(this.debug.logger=(e,t,o,l)=>{try{l=JSON.stringify(l)}catch(d){l=`Object with the following keys failed to stringify: ${Object.keys(l).join(",")}`}typeof o=="symbol"&&(o=o.toString());let i=new Date,a=`${i.getHours()}:${i.getMinutes()}:${i.getSeconds()}.${i.getMilliseconds()}`;console.log(`[${a}][emittery:${e}][${t}] Event Name: ${o}
	data: ${l}`)})}logIfDebugEnabled(r,e,t){(U.isDebugEnabled||this.debug.enabled)&&this.debug.logger(r,this.debug.name,e,t)}on(r,e){me(e),r=Array.isArray(r)?r:[r];for(let t of r)J(t),Q(this,t).add(e),this.logIfDebugEnabled("subscribe",t,void 0),_e(t)||this.emit(fe,{eventName:t,listener:e});return this.off.bind(this,r,e)}off(r,e){me(e),r=Array.isArray(r)?r:[r];for(let t of r)J(t),Q(this,t).delete(e),this.logIfDebugEnabled("unsubscribe",t,void 0),_e(t)||this.emit(pe,{eventName:t,listener:e})}once(r){return new Promise(e=>{let t=this.on(r,o=>{t(),e(o)})})}events(r){r=Array.isArray(r)?r:[r];for(let e of r)J(e);return je(this,r)}emit(r,e){return Y(this,null,function*(){J(r),this.logIfDebugEnabled("emit",r,e),It(this,r,e);let t=Q(this,r),o=V.get(this),l=[...t],i=_e(r)?[]:[...o];yield Ve,yield Promise.all([...l.map(a=>Y(this,null,function*(){if(t.has(a))return a(e)})),...i.map(a=>Y(this,null,function*(){if(o.has(a))return a(r,e)}))])})}emitSerial(r,e){return Y(this,null,function*(){J(r),this.logIfDebugEnabled("emitSerial",r,e);let t=Q(this,r),o=V.get(this),l=[...t],i=[...o];yield Ve;for(let a of l)t.has(a)&&(yield a(e));for(let a of i)o.has(a)&&(yield a(r,e))})}onAny(r){return me(r),this.logIfDebugEnabled("subscribeAny",void 0,void 0),V.get(this).add(r),this.emit(fe,{listener:r}),this.offAny.bind(this,r)}anyEvent(){return je(this)}offAny(r){me(r),this.logIfDebugEnabled("unsubscribeAny",void 0,void 0),this.emit(pe,{listener:r}),V.get(this).delete(r)}clearListeners(r){r=Array.isArray(r)?r:[r];for(let e of r)if(this.logIfDebugEnabled("clear",e,void 0),typeof e=="string"||typeof e=="symbol"){Q(this,e).clear();let t=le(this,e);for(let o of t)o.finish();t.clear()}else{V.get(this).clear();for(let t of he.get(this).values())t.clear();for(let t of ne.get(this).values()){for(let o of t)o.finish();t.clear()}}}listenerCount(r){r=Array.isArray(r)?r:[r];let e=0;for(let t of r){if(typeof t=="string"){e+=V.get(this).size+Q(this,t).size+le(this,t).size+le(this).size;continue}typeof t!="undefined"&&J(t),e+=V.get(this).size;for(let o of he.get(this).values())e+=o.size;for(let o of ne.get(this).values())e+=o.size}return e}bindMethods(r,e){if(typeof r!="object"||r===null)throw new TypeError("`target` must be an object");e=Ye(e);for(let t of e){if(r[t]!==void 0)throw new Error(`The property \`${t}\` already exists on \`target\``);Object.defineProperty(r,t,{enumerable:!1,value:this[t].bind(this)})}}},Xe=Object.getOwnPropertyNames(U.prototype).filter(n=>n!=="constructor");Object.defineProperty(U,"listenerAdded",{value:fe,writable:!1,enumerable:!0,configurable:!1});Object.defineProperty(U,"listenerRemoved",{value:pe,writable:!1,enumerable:!0,configurable:!1});Ze.exports=U});var gt=B(qe()),_=B($());var Qe=B($());var H="grid",C={grid:v({block:H,modifier:["col-resizing","row-resizing"],state:["is-resizing"]}),wrapper:v({block:H,element:"wrapper"}),headerCell:v({block:H,element:"header-cell",modifier:[],state:[]}),cellProgress:v({block:H,element:"cell-progress"}),cellContent:v({block:H,element:"content-cell",state:["is-disabled","is-selected","is-diff","is-same"]}),cellSticky:v({block:H,element:"sticky-cell"}),cell:v({block:H,element:"cell",modifier:["select","date-picker","button"],state:["is-selected","is-disabled","is-readonly","is-active","is-dragging"]}),cellMemo:v({block:H,element:"cell-memo"}),cellError:v({block:H,element:"cell-error"}),active:v({block:H,element:"active"}),th:v({block:H,element:"th",state:["is-active"],modifier:["col-resizing","row-resizing"]}),rowSticky:v({block:H,element:"sticky-row"}),rowHeaderSticky:v({block:H,element:"sticky-row-header"}),thBorderBottom:v({block:H,element:"tbody-bottom-th"}),thBorderRight:v({block:H,element:"tbody-right-th"}),thBorderTop:v({block:H,element:"tbody-top-th"}),thBorderLeft:v({block:H,element:"tbody-left-th"}),textarea:v({block:H,element:"textarea"}),focus:v({block:H,element:"focus"}),colResizerGuide:v({block:H,element:"col-resizer-guide"}),rowResizerGuide:v({block:H,element:"row-resizer-guide"})};var X=B($());var ie="--grid-cell-height",ge=class{constructor({row:r,height:e,rowType:t,top:o}){this._top=-1;this._maxCellHeight=0;this.rowElement=document.createElement("tr"),this.cells=[],this.row=r,this.height=e,this._maxCellHeight=e,this._rowType=t,this._isMounted=!1,this.top=o}get rowInnerHeight(){return this.cells.filter(r=>r.visible&&r.mergeInfo.rowSpan===1).reduce((r,e)=>Math.max(r,e.innerHeight),0)}get isFreezed(){return this.element.classList.contains(C.rowSticky.blockElementName)}get isMounted(){return this._isMounted}get rowId(){return this.row}get isHeader(){return this.element.classList.contains(C.rowHeaderSticky.blockElementName)}get cellCounts(){return this.cells.length}get element(){return this.rowElement}get textColor(){return this.rowElement.style.color}get height(){return parseInt(this.rowElement.style.getPropertyValue(ie)||"0")}get bottom(){return this._top+this.height}get bottomByCellHeight(){return this._top+this._maxCellHeight}get top(){return this._top}get rowType(){return this._rowType}get visible(){return this.element.style.display!=="none"}set rowId(r){this.row=r,this.cells.forEach(e=>e.row=r),this.render()}set customRowZId(r){r===0?this.element.style.removeProperty("z-index"):this.rowElement.classList.contains(C.rowHeaderSticky.blockElementName)?this.element.style.zIndex=`calc(var(--z-index-level-6) + ${r}`:this.element.style.zIndex=`calc(var(--z-index-level-5) + ${r}`}set textColor(r){this.rowElement.style.color=r}set height(r){this.rowElement.style.setProperty(ie,`${r}px`),this.onChangedHeight(this,r)}set top(r){this._top=r,this.element.setAttribute("data-top",r.toString()),this.isFreezed&&(this.element.style.top=`${r}px`)}set visible(r){r?(this.element.style.removeProperty("display"),this.render()):this.element.style.display="none"}unmount(){this._isMounted=!1,this.rowElement.remove()}updateMaxCellHeight(){let r=this.height;this._maxCellHeight=this.cells.reduce((e,t)=>{var o;return Math.max(e,(o=t.height)!=null?o:r)},r)}removeCells(r,e){X.default.range(r,e+1).forEach(o=>this.cells[o].element.remove());let t=1+e-r;this.cells.splice(r,t),X.default.range(r,this.cells.length).forEach(o=>{this.cells[o].col-=t,this.cells[o].render()})}addCell(r){this.cells.push(r),this.rowElement.appendChild(r.element),this.isMounted&&r.render()}insertCells(r,e){if(this.cells.length<e)throw new Error(`Out of length at the row. the length is ${this.cells.length} and you tried inserting with ${e}`);let t=this.cells[e].element;X.default.range(e,this.cells.length).forEach(o=>{this.cells[o].col+=r.length,this.cells[o].render()}),this.cells.splice(e,0,...r),(0,X.default)(r).forEach(o=>{t.insertAdjacentElement("beforebegin",o.element),this.isMounted&&o.render()})}render(){this.visible&&this.cells.forEach(r=>r.render())}getCell(r){return this.cells[r]}*getCellGenerator(r=0,e=this.cells.length-1){for(let t=r;t<=e;++t)yield this.cells[t]}setColumnVisible(r,e){this.cells[r].visible=e}getColumnVisible(r){return this.cells[r].visible}setAutoHeight(r,e){let t=Math.ceil(this.rowInnerHeight),o=O(isNaN(t)?0:t,r,e);return this.height!==o?(this.height=o,!0):!1}getCellLeft(r){return parseInt(this.cells[r].element.style.left||"0")}setCellLeft(r,e){this.cells[r].element.style.left=`${e}px`}setStickyHeader(r){(0,X.default)(this.cells).take(r).forEach(e=>e.freeze()),(0,X.default)(this.cells).drop(r).takeWhile(e=>e.isFreezed).forEach(e=>e.unfreeze())}mount(r,e){this.isMounted||(e?e.insertAdjacentElement("beforebegin",this.element):r.appendChild(this.element),this.render(),this._isMounted=!0,this.onMounted(this))}freeze(){this.element.classList.add(C.rowSticky.blockElementName),this.element.style.top=`${this.top}px`}freezeHeader(){this.element.classList.add(C.rowHeaderSticky.blockElementName,C.rowSticky.blockElementName),this.element.style.top=`${this.top}px`}unfreeze(){this.element.classList.remove(C.rowSticky.blockElementName),this.element.style.removeProperty("top")}onMounted(r){}onChangedHeight(r,e){}};function Me(n,r,e){return Se(n,e)&&ve(r,e)}function Z(n){let r=parseInt(n.getAttribute("data-row")||"-1"),e=parseInt(n.getAttribute("data-col")||"-1");if(r===-1||e===-1)throw new Error("Invalid cell");return{row:r,col:e}}function Se(n,r){return n>=r.top&&n<=r.bottom}function ve(n,r){return n>=r.left&&n<=r.right}function se(n,r,e){e?n.classList.add(r):n.classList.remove(r)}function Te(n){let r=n.firstChild,e=0;for(;r;){let t=r.firstChild;for(;t;)e=Math.max(t.offsetHeight,e),t=t.nextSibling;r=r.nextSibling}return e}var Et=13,yt=(n,r)=>Et+Te(n),xt=(n,r)=>{let e=z(n.style.fontSize,n.style.fontFamily),t=[r.icon,r.sortOrder].reduce((i,a)=>a?i+1:i,0)*20,o=`${r.text||""}`.split(`
`),l=o[0]||"";return(0,Qe.default)(o).drop(1).reduce((i,a)=>Math.max(i,e.calculateWidth(a)),t+e.calculateWidth(l))},_t=[C.th["is-active"],C.thBorderBottom.blockElementName,C.thBorderRight.blockElementName,C.thBorderTop.blockElementName,C.thBorderLeft.blockElementName],Ce=class{constructor({row:r,col:e,tag:t,metaInfo:o,cellRenderer:l}){this._isEditing=!1;this._row=-1;this._col=-1;this._lastEditSelection={start:0,end:0};this._element=document.createElement(t),this._element.rowSpan=1,this._element.colSpan=1,this._metaInfo=j({},o),this._cellRenderer=l,this.row=r,this.col=e,this._element.onclick=()=>this.onClick(this),this._element.onmouseup=i=>{i.button===2&&this.onRightClick(this,i)},this._element.ondblclick=()=>this.onDblClick(this),this._metaInfo.onCalculateWidth=xt,this._metaInfo.onCalculateHeight=yt}get isFreezed(){return this._element.classList.contains(C.cellSticky.blockElementName)||this._element.tagName==="TH"}get dropDisabled(){return this._metaInfo.dropDisabled}get isHeaderCell(){return this._element.tagName==="TH"}get isMerged(){return this.mergeInfo.rowSpan>1||this.mergeInfo.colSpan>1}get isSelected(){return this._element.classList.contains(C.cell["is-selected"])}get innerHeight(){return this._metaInfo.onCalculateHeight?this._metaInfo.onCalculateHeight(this._element,this._metaInfo):Te(this._element)}get mergeArea(){return{top:this.row,left:this.col,bottom:this.row+this._element.rowSpan-1,right:this.col+this._element.colSpan-1}}get innerWidth(){return this._metaInfo.onCalculateWidth?this._metaInfo.onCalculateWidth(this._element,this._metaInfo):0}get isEditing(){return this._isEditing}get mergeInfo(){return{rowSpan:this._element.rowSpan,colSpan:this._element.colSpan}}get mergeMain(){return this._mergeMain}get row(){return this._row}get col(){return this._col}get bottom(){return this.row+this.mergeInfo.rowSpan-1}get right(){return this.col+this.mergeInfo.colSpan-1}get visible(){return this._element.style.display!=="none"}get cellRenderer(){return this._cellRenderer}get text(){let{text:r}=this._metaInfo;return r==null?"":r}get cellType(){return this._element.getAttribute("data-type")}get value(){return this._metaInfo.value}get cellAddress(){return`${this.row},${this.col}`}get object(){return this._metaInfo.object}get metaInfo(){return this._metaInfo}get element(){return this._element}get editable(){return!(this._metaInfo.editable!==!0||this._metaInfo.disabled||this.onCheckReadonly()||this.isEditing)}get lastSelectionStart(){return this._lastEditSelection.start}get lastSelectionEnd(){return this._lastEditSelection.end}get cellInfo(){return this._metaInfo}set visible(r){r&&!this.mergeMain?(this._element.style.removeProperty("display"),this.render()):this._element.style.display="none"}set isDragOver(r){r?this._element.classList.add(C.cell["is-dragging"]):this._element.classList.remove(C.cell["is-dragging"])}set text(r){this.cellInfo={text:r}}set cellInfo(r){Object.assign(this._metaInfo,r),this.render(),this._metaInfo.emitter.emit("onCellInfoChanged",{row:this.row,col:this.col})}set cellType(r){this._element.setAttribute("data-type",r)}set height(r){r?this._element.style.setProperty(ie,`${r}px`):this._element.style.removeProperty(ie)}set mergeInfo({rowSpan:r=1,colSpan:e=1}){r===1&&(this.height=null),this._element.rowSpan=r,this._element.colSpan=e,this.render()}set mergeMain(r){this._mergeMain=r,this.visible=r===void 0}set row(r){this._row=r,this._element.setAttribute("data-row",r.toString())}set col(r){this._col=r,this._element.setAttribute("data-col",r.toString())}set cellRenderer(r){this._cellRenderer=r,this.render()}select(){this.isSelected||(this._element.classList.add(C.cell["is-selected"]),this.onSelect(this))}release(){this._element.classList.remove(C.cell["is-selected"]),this.deactivate()}activate(){this._mergeMain?this._mergeMain._element.classList.add(C.th["is-active"]):this._element.classList.add(C.th["is-active"])}deactivate(){this.syncClassRemoveWithMergeMain(..._t)}setBorderLeft(){this.syncClassAddWithMergeMain(C.thBorderLeft.blockElementName)}setBorderTop(){this.syncClassAddWithMergeMain(C.thBorderTop.blockElementName)}setBorderBottom(){this.syncClassAddWithMergeMain(C.thBorderBottom.blockElementName)}setBorderRight(){this.syncClassAddWithMergeMain(C.thBorderRight.blockElementName)}updateReadonlyStatus(){se(this._element,C.cell["is-readonly"],this.onCheckReadonly())}updateCellStatus(){se(this._element,C.cell["is-disabled"],this._metaInfo.disabled===!0),se(this._element,"is-asc",this._metaInfo.sortOrder==="ASC"),se(this._element,"is-desc",this._metaInfo.sortOrder==="DESC"),this.updateReadonlyStatus(),this._metaInfo.tooltip!==void 0?this._element.setAttribute("title",this._metaInfo.tooltip):this._element.setAttribute("title",this._metaInfo.text||""),this._metaInfo.isError?this.addMark(C.cellError.blockElementName):this._metaInfo.hasMemo?this.addMark(C.cellMemo.blockElementName):this._mark&&this.removeMark(),this._element.style.textAlign=this._metaInfo.horizontalAlign||"",this._element.style.verticalAlign=this._metaInfo.verticalAlign||"",this._element.style.fontSize=this._metaInfo.fontSize||"12px",this._element.style.fontFamily=this._metaInfo.fontFamily||'"Noto Sans KR", sans-serif',this._element.style.color=this._metaInfo.textColor||"",this._element.style.backgroundColor=this._metaInfo.backColor||""}render(){this.visible&&(this.removeChildren(),this.updateCellStatus(),this._element.appendChild(this._cellRenderer(this.row,this.col,this._metaInfo)))}doEditMode(r){var d;if(!this._element.isConnected||this.editable===!1)return!1;this._isEditing=!0,this.removeChildren();let e=document.createElement("div"),t=document.createElement("textarea"),o=(d=this._metaInfo.text)!=null?d:"";t.className=C.textarea.blockElementName,t.value=o,r&&(t.value+=r),e.appendChild(t),this._element.appendChild(e),t.onmousedown=s=>s.stopPropagation(),t.onclick=s=>s.stopPropagation(),t.onmouseup=s=>s.stopPropagation();let l=(s,c)=>{var u;t.removeEventListener("blur",i),s?this.cellInfo={text:t.value}:t.value=(u=this._metaInfo.text)!=null?u:"",this._isEditing=!1,this.render(),this._lastEditSelection={start:t.selectionStart,end:t.selectionEnd},this.onEditDone(this,s,o,c,t.selectionStart,t.selectionEnd)},i=()=>l(o!==t.value,""),a=s=>s.key==="ArrowLeft"&&t.selectionStart===0&&t.selectionEnd===0?(this.onMoveLeftOnEdit(s.ctrlKey,s.shiftKey),!0):s.key==="ArrowUp"&&t.selectionStart===0&&t.selectionEnd===0?(this.onMoveUpOnEdit(s.ctrlKey,s.shiftKey),!0):s.key==="ArrowRight"&&t.selectionStart===t.textLength&&t.selectionEnd===t.textLength?(this.onMoveRightOnEdit(s.ctrlKey,s.shiftKey),!0):s.key==="ArrowDown"&&t.selectionStart===t.textLength&&t.selectionEnd===t.textLength?(this.onMoveDownOnEdit(s.ctrlKey,s.shiftKey),!0):s.key==="Tab"?(this.onTabOnEdit(s.ctrlKey,s.shiftKey),s.preventDefault(),!0):!1;return t.addEventListener("blur",i),t.onkeydown=s=>{if(s.stopPropagation(),a(s)){l(o!==t.value,s.key);return}if(s.key==="Escape")l(!1,s.key);else if(s.key==="Enter")if(s.altKey){t.readOnly=!0;let c=t.value.substring(0,t.selectionStart);t.value=[t.value.substring(0,t.selectionStart),`
`,t.value.substring(t.selectionEnd)].join(""),t.readOnly=!1,t.selectionEnd=c.length+1}else l(o!==t.value,s.key),this.onEnterOnEdit(s.ctrlKey,s.shiftKey);else this.onEditKeyDown(s,this.row,this.col,this._metaInfo)},t.focus(),this.onStartEdit(this),!0}clear(){this.cellInfo={text:""},this.onClear(this)}freeze(){this._element.classList.add(C.cellSticky.blockElementName)}unfreeze(){this._element.classList.remove(C.cellSticky.blockElementName),this._element.style.removeProperty("left")}onClick(r){}onDblClick(r){}onRightClick(r,e){}onSelect(r){}onEditDone(r,e,t,o,l,i){}onStartEdit(r){}onClear(r){}onEditKeyDown(r,e,t,o){}onCheckReadonly(){return this._metaInfo.readonly===!0}onMoveLeftOnEdit(r,e){}onMoveRightOnEdit(r,e){}onMoveUpOnEdit(r,e){}onMoveDownOnEdit(r,e){}onTabOnEdit(r,e){}onEnterOnEdit(r,e){}removeChildren(){for(;this._element.firstChild;)this._element.firstChild.remove()}syncClassAddWithMergeMain(...r){this.mergeMain?this.mergeMain._element.classList.add(...r):this._element.classList.add(...r)}syncClassRemoveWithMergeMain(...r){this.mergeMain?this.mergeMain._element.classList.remove(...r):this._element.classList.remove(...r)}addMark(r){this._mark||(this._mark=document.createElement("div")),this._mark.className=r,this._element.appendChild(this._mark)}removeMark(){this._mark&&(this._mark.remove(),this._mark=void 0)}};var Gt=n=>{var t;let r=document.createElement("div"),e=document.createElement("span");if(e.innerText=(t=n.text)!=null?t:"",r.className=C.cellContent.blockElementName,n.sortOrder!==void 0){let o=n.sortOrder==="ASC"?"sort-ascending":"sort-descending",l=document.createElement("i");l.className=`ir-icon ir-icon--${o}`,r.appendChild(l)}if(n.icon){let o=document.createElement("i");o.classList.add("ir-icon",`ir-icon--${n.icon}`),n.iconColor&&o.style.setProperty("--ir-icon-foreground-color",n.iconColor),r.appendChild(o)}return r.appendChild(e),r},Mt=(n,r,e,t)=>{var i;let o=document.createElement("div"),l=document.createElement("span");if(l.innerText=(i=e.text)!=null?i:"",o.className=C.cellContent.blockElementName,e.icon){let a=document.createElement("button"),d=document.createElement("i");a.setAttribute("type","button"),a.classList.add("icon-button"),a.ondblclick=s=>s.stopPropagation(),a.onclick=s=>{t&&t(s,n,r),s.stopPropagation()},d.classList.add("ir-icon",`ir-icon--${e.icon}`),e.iconColor&&d.style.setProperty("--ir-icon-foreground-color",e.iconColor),a.appendChild(d),o.appendChild(a)}return o.appendChild(l),o},et=()=>(n,r,e)=>(e.cellType="default",Gt(e));function ur({onClick:n}){return(r,e,t)=>(t.cellType="default",Mt(r,e,t,n))}function mr(n,...r){return(e,t,o)=>{let l=document.createElement("div"),i=document.createElement("div"),a=e-n;o.cellType="rowNo",l.className=C.cellContent.blockElementName;let d=a<r.length?r[a]:`${1+a-r.length}`;return i.innerText=d,o.text=d,l.appendChild(i),l}}var Le=B($());function St(n){switch(n){case'"':return"quotes";case"	":return"tab";case`
`:return"line";default:return"text"}}function tt(n){return{getSelectedText:()=>{let r=n.getSelection(),e=[];return r&&Le.default.range(r.top,r.bottom+1).forEach(t=>{let o=Le.default.range(r.left,r.right+1).reduce((l,i)=>{let d=n.cell(t,i).text.toString().replace(/"/g,'""');return l.push(`"${d}"`),l},[]);e.push(o.join("	"))}),e.join(`
`)},convertText:r=>{let e=[],t=r.replace(/\r\n/g,`
`),o=[],l=0;function i(){e.push(o),o=[],++l}function a(u,p){o.push(t.substring(u,p+1).replace(/""/g,'"'))}function d(){let u=++l;for(;l<t.length;){if(t[l]==='"')if(l+1<t.length&&t[l+1]==='"')++l;else break;++l}a(u,l-1),++l}function s(){let u=l;e:for(;l<t.length;){switch(t[l]){case"	":case`
`:break e;default:}++l}a(u,l-1)}function c(){++l,l<t.length&&(t[l]==='"'?d():s())}for(;l<t.length;){let u=t[l];switch(St(u)){case"quotes":d();break;case"text":s();break;case"tab":c();break;case"line":i();break;default:}}return o.length>0&&e.push(o),e}}}function be(n){let r=(h,I,w)=>{var b;let R=n.headerRows,f=w,g=h;for(;f!==0;){let E=n.cell(g,I),x=((b=E.mergeMain)!=null?b:E).row-1;if(x<R)break;n.getRowVisible(x)&&++f,g=x}return g},e=(h,I,w)=>{var b;let R=n.getRowCount()-1,f=w,g=h;for(;f!==0;){let E=n.cell(g,I),x=((b=E.mergeMain)!=null?b:E).bottom+1;if(x>R)break;n.getRowVisible(x)&&--f,g=x}return g},t=(h,I,w)=>{var b;let R=n.headerColumns,f=w,g=I;for(;f!==0;){let E=n.cell(h,g),x=((b=E.mergeMain)!=null?b:E).col-1;if(x<R)break;n.getColumnVisible(x)&&++f,g=x}return g},o=(h,I,w)=>{var b;let R=n.getColCount()-1,f=w,g=I;for(;f!==0;){let E=n.cell(h,g),x=((b=E.mergeMain)!=null?b:E).right+1;if(x>R)break;n.getColumnVisible(x)&&--f,g=x}return g},l=()=>{let h=n.headerColumns;for(;!n.getColumnVisible(h);)++h;return h},i=()=>{let h=n.getColCount()-1;for(;!n.getColumnVisible(h);)--h;return h},a=()=>{let h=n.headerRows;for(;!n.getRowVisible(h);)++h;return h},d=()=>{let h=n.getRowCount()-1;for(;!n.getRowVisible(h);)--h;return h},s=h=>{if(n.getRowCount()-1===h)return h;let w=h+1;for(;!n.getRowVisible(w);)++w;return w},c=h=>{let I=n.headerRows;if(h===I)return h;let w=h-1;for(;!n.getRowVisible(w);)++w;return w},u=()=>{var f;let{activeCell:h}=n;if(!h){console.warn("No active cell warning.");return}let I=d(),w=i(),R=(f=h.mergeMain)!=null?f:h;if(R.right===w){if(h.row===I)return;let g=l(),b=s(h.row);n.selectCell(b,g),n.scrollInView(b,g)}else{let g=o(h.row,R.right,1);n.selectCell(h.row,g),n.scrollOnCol(g)}},p=()=>{var f;let{activeCell:h}=n;if(!h){console.warn("No active cell warning.");return}let I=a(),w=l(),R=(f=h.mergeMain)!=null?f:h;if(R.col===w){if(h.row===I)return;let g=i(),b=c(h.row);n.selectCell(b,g),n.scrollInView(b,g)}else{let g=t(h.row,R.col,-1);n.selectCell(h.row,g),n.scrollOnCol(g)}},m=(h,I,w)=>{var g;let R=-1,f=-1;for(let b=I;b<=w;b++){let E=n.cell(h,b),S=(g=E.mergeMain)!=null?g:E,{rowSpan:x}=S.mergeInfo;x>R&&(R=x,f=b)}return f},M=(h,I,w)=>{var f;let R=-1;for(let g=I;g<=w;g++){let b=n.cell(h,g),E=(f=b.mergeMain)!=null?f:b,{bottom:S}=E;S>R&&(R=S)}return R},y=(h,I,w)=>{var f;let R=999999999;for(let g=I;g<=w;g++){let b=n.cell(h,g),E=(f=b.mergeMain)!=null?f:b;R>E.row&&(R=E.row)}return R},G=(h,I,w)=>{var g;let R=-1,f=-1;for(let b=I;b<=w;b++){let E=n.cell(b,h),S=(g=E.mergeMain)!=null?g:E,{colSpan:x}=S.mergeInfo;x>R&&(R=x,f=b)}return f},T=(h,I,w)=>{var f;let R=-1;for(let g=I;g<=w;g++){let b=n.cell(g,h),E=(f=b.mergeMain)!=null?f:b,{right:S}=E;S>R&&(R=S)}return R},k=(h,I,w)=>{var f;let R=999999999;for(let g=I;g<=w;g++){let b=n.cell(g,h),E=(f=b.mergeMain)!=null?f:b;R>E.col&&(R=E.col)}return R};return{getNextYAbove:r,getNextYBelow:e,getNextXLeft:t,getNextXRight:o,selectNextActiveCell:u,selectBeforeActiveCell:p,selectNextSelection:(h,I,w)=>{var He;let R=n.getSelection(),{activeCell:f}=n;if(R==null||f==null){console.warn("No selection warning");return}let g=(He=f.mergeMain)!=null?He:f;if(!w){if(h!==0){let K=h<0?r(g.row,f.col,h):e(g.bottom,f.col,h);n.selectCell(K,f.col),n.scrollOnRow(K)}else{let K=I<0?t(f.row,g.col,I):o(f.row,g.right,I);n.selectCell(f.row,K),n.scrollOnCol(K)}return}let{top:b,bottom:E,left:S,right:x}=R;if(h!==0)if(h<0)if(M(f.row,S,x)===E){let D=m(b,S,x),L=r(b,D,h);n.selectRange(L,S,E,x,f),n.scrollOnRow(L)}else{let D=m(E,S,x),L=r(E,D,h);n.selectRange(b,S,L,x,f),n.scrollOnRow(L)}else if(y(f.row,S,x)===b){let D=m(E,S,x),L=e(E,D,h);n.selectRange(b,S,L,x,f),n.scrollOnRow(L)}else{let D=m(b,S,x),L=e(b,D,h);n.selectRange(L,S,E,x,f),n.scrollOnRow(L)}else if(I<0)if(T(f.col,b,E)===x){let D=G(S,b,E),L=t(D,S,I);n.selectRange(b,L,E,x,f),n.scrollOnCol(L)}else{let D=G(x,b,E),L=t(D,x,I);n.selectRange(b,S,E,L,f),n.scrollOnCol(L)}else if(k(f.col,b,E)===S){let D=G(x,b,E),L=o(D,x,I);n.selectRange(b,S,E,L,f),n.scrollOnCol(L)}else{let D=G(S,b,E),L=o(D,S,I);n.selectRange(b,L,E,x,f),n.scrollOnCol(L)}},selectMoveToLastColumn:h=>{let I=n.getSelection(),{activeCell:w}=n;if(I==null||w==null){console.warn("No selection warning");return}let R=i();h?n.selectRange(I.top,w.col,I.bottom,R,w):n.selectCell(w.row,R),n.scrollOnCol(R)},selectMoveToFirstColumn:h=>{let I=n.getSelection(),{activeCell:w}=n;if(I==null||w==null){console.warn("No selection warning");return}let R=l();h?n.selectRange(I.top,R,I.bottom,w.col,w):n.selectCell(w.row,R),n.scrollOnCol(R)},selectMoveToLastRow:h=>{let I=n.getSelection(),{activeCell:w}=n;if(I==null||w==null){console.warn("No selection warning");return}let R=d();h?n.selectRange(w.row,I.left,R,I.right,w):n.selectCell(R,w.col),n.scrollOnRow(R)},selectMoveToFirstRow:h=>{let I=n.getSelection(),{activeCell:w}=n;if(I==null||w==null){console.warn("No selection warning");return}let R=a();h?n.selectRange(R,I.left,w.bottom,I.right,w):n.selectCell(R,w.col),n.scrollOnRow(R)}}}function rt(n,r){r.on("updateCellStatus",e=>n.cell(e.row,e.col).updateCellStatus())}var ot=B($());function nt(n,r){let e={text:"",ignoreCase:!0,matchAll:!1,area:"all",direction:"top-bottom"},t=!1,o=()=>e.hasHeaderRows?0:n.headerRows,l=()=>e.hasHeaderColumns?0:n.headerColumns;function*i(){let s=o(),c=l(),u=n.getSelection();for(t=!1;;){switch(e.area){case"all":yield n.cell(s,c);break;case"selected-col":if(!u)throw new Error("No selection in finding");ve(c,u)&&(yield n.cell(s,c));break;case"selected-row":if(!u)throw new Error("No selection in finding");Se(s,u)&&(yield n.cell(s,c));break;case"selection":if(!u)throw new Error("No selection in finding");Me(s,c,u)&&(yield n.cell(s,c));break;case"custom":if(!e.customRange)throw new Error("Please call with customRange in 'custom' finding.");Me(s,c,e.customRange)&&(yield n.cell(s,c));break;default:break}if(e.direction==="top-bottom"){if(++s,s===n.getRowCount()&&(++c,s=o()),c===n.getColCount())if(t)t=!1,s=o(),c=l();else break}else if(++c,c===n.getColCount()&&(++s,c=l()),s===n.getRowCount())if(t)t=!1,s=o(),c=l();else break}}function a(s){let c=e.text.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),u=e.matchAll?`^${c}$`:c,p=e.ignoreCase?"i":"",m=new RegExp(u,p);return r.onCellCheck?r.onCellCheck(m,s):m.test(s.text)}let d=i();return{resetCursor:()=>{d=i()},findNext:s=>{for(ot.default.isEqual(e,s)||(d=i()),Object.assign(e,s);;){let c=d.next();if(!c.done&&a(c.value))return t=!0,c.value;if(c.done)break}return null},getAllMatchedCell:s=>{let c=[];s&&Object.assign(e,s);for(let u of i())a(u)&&c.push(u);return c}}}function W(n){return{getSelectionGenerator:function*({top:r,left:e,bottom:t,right:o}){o=Math.min(o,n.getColCount()-1),t=Math.min(t,n.getRowCount()-1);for(let l=r;l<=t;l++)for(let i=e;i<=o;i++)yield n.cell(l,i)},getSelectionHeaderIterator:function*({top:r,left:e,bottom:t,right:o}){o=Math.min(o,n.getColCount()-1),t=Math.min(t,n.getRowCount()-1);for(let l=0;l<n.headerRows;++l)for(let i=e;i<=o;++i)yield n.cell(l,i);for(let l=r;l<=t;++l)for(let i=0;i<n.headerColumns;++i)yield n.cell(l,i)},getSelectionHeaderBorderRight:function*({top:r,bottom:e}){e=Math.min(e,n.getRowCount()-1);for(let t=r;t<=e;++t)for(let o=n.headerColumns-1;o>=0;--o){let l=n.cell(t,o);if(l.visible){yield l;break}}},getSelectionHeaderBorderBottom:function*({left:r,right:e}){e=Math.min(e,n.getColCount()-1);for(let t=r;t<=e;++t)for(let o=n.headerRows-1;o>=0;--o){let l=n.cell(o,t);if(l.visible){yield l;break}}}}}var lt=(n,r)=>{let e=W(n),t={RESIZE_COLUMN({col:o,width:l}){let i=n.getColumnWidth(o);n.setColumnWidth(o,l),r.pushCommand({type:"CHANGE_COL_WIDTH",context:{col:o,newSize:l,oldSize:i}})},RESIZE_ROW({row:o,height:l}){let i=n.getRowHeight(o);n.setRowHeight(o,l),r.pushCommand({type:"CHANGE_ROW_HEIGHT",context:{row:o,newSize:l,oldSize:i}})},ADD_ROW(o={height:void 0}){let l=n.addRow(o.height);return r.pushCommand({type:"ADD_ROW",context:{row:l,height:o.height}}),l},ADD_COLUMN(o={width:void 0}){let l=n.addColumn(o.width);return r.pushCommand({type:"ADD_COLUMN",context:{col:l,width:o.width}}),l},CLEAR_CELLS(o){let l=[];for(let i of e.getSelectionGenerator(o))i.metaInfo.disabled!==!0&&i.onCheckReadonly()!==!0&&i.metaInfo.cellType!=="select"&&i.text&&(l.push({row:i.row,col:i.col,key:"text",oldValue:i.text,newValue:""}),i.clear());l.length!==0&&r.pushCommand({type:"UPDATE_CELLS",context:{cellInfoList:l}})},DONE_CELL_EDIT({row:o,col:l,beforeText:i,text:a}){r.pushCommand({type:"UPDATE_CELLS",context:{cellInfoList:[{row:o,col:l,key:"text",newValue:a,oldValue:i}]}})},SET_TEXT({row:o,col:l,text:i}){let a=n.getText(o,l);n.setText(o,l,i),r.pushCommand({type:"UPDATE_CELLS",context:{cellInfoList:[{row:o,col:l,key:"text",newValue:i,oldValue:a}]}})}};return{doCommand(o,l){return t[o](l)}}};var q=B($());function it(n){let r=[],e=W(n);function t({top:s,left:c,bottom:u,right:p}){return(0,q.default)(r).some(({mergeArea:m})=>c<=m.right&&p>=m.left&&s<=m.bottom&&u>=m.top)===!1}function o(s,c){return q.default.range(s,c+1).filter(u=>n.getRowVisible(u)).reduce(u=>u+1,0)}function l(s,c){return q.default.range(s,c+1).filter(u=>n.getColumnVisible(u)).reduce(u=>u+1,0)}function i({top:s,left:c,bottom:u,right:p}){return!!(q.default.range(s,u+1).some(m=>n.getRowVisible(m)===!1)||q.default.range(c,p+1).some(m=>n.getColumnVisible(m)===!1))}function a(s,c){let u=n.cell(s,c),p=r.indexOf(u);if(p>=0)return r[p]}let d={isValidatedMerging:t,getMergedRowHeight:(s,c)=>q.default.range(s,c+1).filter(u=>n.getRowVisible(u)).reduce((u,p)=>u+n.getRowHeight(p),0),mergeCells:s=>{if(s.top>s.bottom||s.left>s.right)throw new Error("Invalid range");if(t(s)===!1)throw new Error("Could not merging with Conflicted cells!");if(i(s))throw new Error("Could not merging with hidden cells!");if(s.top===s.bottom&&s.left===s.right)throw new Error("Could not merging with single cell!");let c=n.cell(s.top,s.left);c.height=d.getMergedRowHeight(s.top,s.bottom),c.mergeInfo={rowSpan:o(s.top,s.bottom),colSpan:l(s.left,s.right)},r.push(c);let u=n.getRow(s.top);u.updateMaxCellHeight(),s.top<n.headerRows&&(u.customRowZId=n.headerRows-s.top);for(let p of e.getSelectionGenerator(s))(p.row!==s.top||p.col!==s.left)&&(p.mergeMain=c,p.metaInfo.text="")},splitCells:(s,c)=>{let u=a(s,c);if(!u)throw new Error("Could not split on a not merged cell!");for(let p of e.getSelectionGenerator(u.mergeArea))p.mergeMain=void 0,p.mergeInfo={rowSpan:1,colSpan:1};d.removeMergeCell(s,c),n.getRow(s).updateMaxCellHeight()},isMerged:(s,c)=>!t({top:s,left:c,bottom:s,right:c}),*getMergedCellGenerator(s){for(let c of e.getSelectionGenerator(s))(c.mergeInfo.rowSpan>1||c.mergeInfo.colSpan>1)&&(yield c)},removeMergeCell:(s,c)=>{let u=a(s,c);if(!u)throw new Error("Could not split on a not merged cell!");r.splice(r.indexOf(u),1)},checkConflictingInRows(s,c){for(let{mergeArea:u}of r)if(u.top<s&&u.bottom>=s&&u.bottom<=c||u.bottom>c&&u.top>=s&&u.top<=c||u.top<s&&u.bottom>c)return!0;return!1},checkConflictingInColumns(s,c){for(let{mergeArea:u}of r)if(u.left<s&&u.right>=s&&u.right<=c||u.right>c&&u.left>=s&&u.left<=c||u.left<s&&u.right>c)return!0;return!1},checkCanInsertRow(s){for(let{mergeArea:c}of r)if(c.top<s&&c.bottom>=s)return!1;return!0},checkCanInsertColumn(s){for(let{mergeArea:c}of r)if(c.left<s&&c.right>=s)return!1;return!0}};return d}var vt=12,Tt=8;function st(n){return n.mergeInfo?n.col+n.mergeInfo.colSpan-1:n.col}function at(n){return n.mergeInfo?n.row+n.mergeInfo.rowSpan-1:n.row}function Lt({grid:n,context:r,enabledColResizer:e,enabledRowResizer:t}){(function(){let a=document.createElement("div"),d=!1,s=null,c=0;function u(){r.classList.remove(C.grid["col-resizing"]),r.classList.remove(C.grid["row-resizing"]),r.classList.remove(C.grid["is-resizing"]),s&&r.removeEventListener("mousedown",s)}function p(y,G){s&&r.removeEventListener("mousedown",s),r.classList.remove(C.grid["col-resizing"]),r.classList.remove(C.grid["row-resizing"]),r.classList.add(C.grid[G]),r.classList.add(C.grid["is-resizing"]);let T=0,k=0,A=0,N=0,P=0;function re(){return y.col<n.getFreezedColumnCount()?n.scrollLeft+N:N}function Ee(){return y.row<n.getFreezedRowCount()?n.scrollTop+N:N}s=f=>{let g=new Date().getTime();if(g-c<=500){G==="col-resizing"?n.autoSizeColumn(y.col):n.autoSizeRow(y.row),c=0;return}d=!0,c=g,y.element.classList.add(C.th[G]),G==="col-resizing"?(a.className=C.colResizerGuide.blockElementName,P=n.getColumnWidth(st(y)),T=f.pageX,k=T-P+n.minColWidth,A=T-P+n.maxColWidth,N=n.getColumnLeft(y.col)+n.getCellWidth(y),a.style.cssText=ye({top:"0px",width:"0px",height:`${n.height}px`,left:`${re()}px`})):(a.className=C.rowResizerGuide.blockElementName,P=n.getRowHeight(at(y)),T=f.pageY,k=T-P+n.minRowHeight,A=T-P+n.maxRowHeight,N=n.getRow(y.row).top+n.getCellHeight(y),a.style.cssText=ye({top:`${Ee()}px`,width:`${n.width}px`,height:"0px",left:"0px"})),r.appendChild(a),n.addGlobalEventListener(document,"keydown",R),n.addGlobalEventListener(document,"mouseup",I),n.addGlobalEventListener(document,"mousemove",h)};let h=f=>{if(G==="col-resizing"){let g=O(f.pageX,k,A)-T;a.style.left=`${re()+g}px`}else{let g=O(f.pageY,k,A)-T;a.style.top=`${Ee()+g}px`}},I=f=>{if(G==="col-resizing"){let E=O(f.pageX,k,A)-T;Math.abs(E)>4&&(n.doCommand("RESIZE_COLUMN",{col:st(y),width:P+E}),c=0)}else{let E=O(f.pageY,k,A)-T;Math.abs(E)>4&&(n.doCommand("RESIZE_ROW",{row:at(y),height:P+E}),c=0)}w();let g=o(f);if(!g)return;let b=l(f,g);b!==null&&p(g,b)};function w(){d=!1,a.remove(),u(),y.element.classList.remove(C.th[G]),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",I),document.removeEventListener("keydown",R)}let R=f=>{f.key==="Escape"&&w()};n.addGlobalEventListener(r,"mousedown",s)}let m=y=>{if(d)return;let G=o(y);if(G===null){u();return}let T=l(y,G);T===null?u():p(G,T)},M=y=>{u()};n.addGlobalEventListener(r,"mousemove",m),n.addGlobalEventListener(r,"mouseout",M)})();function o(i){let a=i.target.closest("th");if(!a)return null;let[d,s]=[parseInt(a.getAttribute("data-row")||"-1"),parseInt(a.getAttribute("data-col")||"-1")];return n.cell(d,s)}function l(i,a){return a.cellType==="body-cell"?null:e&&Math.abs(n.getCellWidth(a)-i.offsetX)<=vt?"col-resizing":t&&Math.abs(n.getCellHeight(a)-i.offsetY)<=Tt?"row-resizing":null}return n}function ct(n){return(r,e,t)=>Lt(j({grid:r,table:e,context:t},n))}var dt=B($());var ke=B($());function ee(n){let r=W(n);function e(o){let l=ke.default.clone(o),i=[...r.getSelectionGenerator(o)];for(;i.length;){let a=i.pop();if(!a.isMerged&&!a.mergeMain)continue;let d=a.mergeMain?a.mergeMain.mergeArea:a.mergeArea;if(d.top<l.top){for(let s of r.getSelectionGenerator({top:d.top,left:l.left,bottom:l.top-1,right:l.right}))i.push(s);l.top=d.top}if(d.left<l.left){for(let s of r.getSelectionGenerator({top:l.top,left:d.left,bottom:l.bottom,right:l.left-1}))i.push(s);l.left=d.left}if(l.bottom<d.bottom){for(let s of r.getSelectionGenerator({top:l.bottom+1,left:l.left,bottom:d.bottom,right:l.right}))i.push(s);l.bottom=d.bottom}if(l.right<d.right){for(let s of r.getSelectionGenerator({top:l.top,left:l.right+1,bottom:l.bottom,right:d.right}))i.push(s);l.right=d.right}}return l}function t(o){let l=ke.default.clone(o),i=n.headerRows,a=n.headerColumns,d=n.getRowCount()-1,s=n.getColCount()-1;return l.top=O(l.top,i,d),l.left=O(l.left,a,s),l.bottom=O(l.bottom,i,d),l.right=O(l.right,a,s),l}return{extendRange:o=>e(o),releaseCells:o=>{let l=t(o);for(let i of r.getSelectionGenerator(l))i.release();for(let i of r.getSelectionHeaderIterator(l))i.release()},selectRange:o=>{let l=t(o),i=e(l);for(let a of r.getSelectionGenerator(i))a.select();for(let a=i.top;a<=i.bottom;++a)n.cell(a,i.left).setBorderLeft(),n.cell(a,i.right).setBorderRight();for(let a=i.left;a<=i.right;++a)n.cell(i.top,a).setBorderTop(),n.cell(i.bottom,a).setBorderBottom();for(let a of r.getSelectionHeaderIterator(i))a.activate();return i}}}function kt(n,r){let e=null,t=ee(n);r.addEventListener("mousedown",o=>{if(o.button!==0)return;let l=o.target.closest("td");if(!l||(l==null?void 0:l.tagName)==="TH")return;let i=Z(l);e=n.cell(i.row,i.col),n.selectRange(e.row,e.col,e.bottom,e.right,e)}),r.addEventListener("mousemove",o=>{if(!e)return;let l=o.target.closest("td");if(!l||l.tagName==="TH")return;let i=Z(l),a=n.cell(i.row,i.col),d=[e.row,e.bottom,a.row,a.bottom],s=[e.col,e.right,a.col,a.right],c={top:Math.min(...d),left:Math.min(...s),bottom:Math.max(...d),right:Math.max(...s)},u=t.extendRange(c);dt.default.isEqual(n.getSelection(),u)===!1&&n.selectRange(u.top,u.left,u.bottom,u.right,e)}),n.addGlobalEventListener(document,"mouseup",()=>e=null)}function ut(){return kt}var Ht=(n,r,e)=>{let t=document.createElement("textarea"),o=W(n),{selectNextActiveCell:l,selectNextSelection:i,selectBeforeActiveCell:a,selectMoveToFirstRow:d,selectMoveToFirstColumn:s,selectMoveToLastColumn:c,selectMoveToLastRow:u}=be(n);t.className=C.focus.blockElementName,e.appendChild(t),n.addCoreElement(t),n.addGlobalEventListener(e,"focus",()=>{document.activeElement!==t&&t.focus()}),n.addGlobalEventListener(e,"mouseup",()=>t.focus()),n.addGlobalEventListener(e,"input",m=>{var y;if(!n.activeCell)return;let M=(y=n.activeCell.mergeMain)!=null?y:n.activeCell;!M.isEditing&&m.data&&M.doEditMode(m.data)}),t.addEventListener("paste",m=>n.onNativePaste(m)),t.addEventListener("copy",m=>n.onNativeCopy(m)),t.addEventListener("cut",m=>n.onNativeCut(m));let p={Tab:m=>{m.shiftKey?a():l()},ArrowRight:m=>{m.ctrlKey?c(m.shiftKey):i(0,1,m.shiftKey)},ArrowUp:m=>{m.ctrlKey?d(m.shiftKey):i(-1,0,m.shiftKey)},ArrowLeft:m=>{m.ctrlKey?s(m.shiftKey):i(0,-1,m.shiftKey)},ArrowDown:m=>{m.ctrlKey?u(m.shiftKey):i(1,0,m.shiftKey)},Home:m=>{s(m.shiftKey)},End:m=>{c(m.shiftKey)},PageUp:m=>{i(-10,0,m.shiftKey)},PageDown:m=>{i(10,0,m.shiftKey)},Enter:()=>{i(1,0,!1)},a:m=>{m.ctrlKey&&n.selectAll()},z:m=>{m.ctrlKey&&n.undo()},y:m=>{m.ctrlKey&&n.redo()},F2:m=>{var y;if(n.activeCell===null)return;((y=n.activeCell.mergeMain)!=null?y:n.activeCell).doEditMode()},Delete:m=>{let M=n.getSelection();!M||n.doCommand("CLEAR_CELLS",M)}," ":m=>{var y;let M=n.getSelection();if(!!M)for(let G of o.getSelectionGenerator(M))G.onCheckReadonly()||G.metaInfo.disabled||G.metaInfo.cellType==="checkbox"&&((y=G.element.querySelector("input"))==null||y.click())}};return n.addGlobalEventListener(e,"keydown",m=>{if(t.value="",p[m.key])try{p[m.key](m)}finally{m.key!=="a"&&(m.preventDefault(),m.stopPropagation())}}),n},mt=()=>Ht;function At(n,r){let e=null,t=ee(n);return r.addEventListener("mousedown",o=>{if(o.button!==0)return;let l=o.target.closest("td");if(!l||(l==null?void 0:l.tagName)==="TH")return;let i=Z(l);e=n.cell(i.row,i.col),n.selectRange(e.row,n.headerColumns,e.row,n.getColCount(),e)}),n.addGlobalEventListener(document,"mouseup",()=>e=null),n}function Nr(){return At}function Ot(n,r,e){function t(o){let{display:l,width:i}=getComputedStyle(e);if(l==="none"){console.warn("IR_GRID_COLUMN_FILL_PLUGIN::Could not be the column-fill plugin because display is none!");return}console.log(i)}return n.emitter.on("onContextResized",()=>t(-1)),n.emitter.on("onColumnResized",({col:o})=>t(o)),n}function Wr(){return Ot}function Dt(n,{onCellInfoChanged:r}){let e=({row:o=-1,col:l=-1})=>{r(n,o,l)},t={turnOn:()=>n.emitter.on("onCellInfoChanged",e),turnOff:()=>n.emitter.off("onCellInfoChanged",e)};return t.turnOn(),t}function Fr(n){return r=>Dt(r,n)}var zt={enabledOnHeader:!1};function Nt(n,r,{enabledOnHeader:e}){let t={latestDragOverCell:null};function o(){r.classList.remove("is-dragging"),l()}function l(){!t.latestDragOverCell||(t.latestDragOverCell.isDragOver=!1)}function i(d){l(),t.latestDragOverCell=d,d.isDragOver=!0}function a(){return r.classList.contains("is-dragging")}r.addEventListener("mouseup",()=>a()&&o()),r.addEventListener("dragenter",()=>{r.classList.add("is-dragging")}),r.addEventListener("dragover",d=>{if(!r.classList.contains("is-dragging"))return;let s=n.findCellOrNull(d.offsetY,d.offsetX);if(!s)return null;if(console.log(s.dropDisabled),s.dropDisabled!==!1&&(s.isHeaderCell&&e===!1||s.metaInfo.disabled===!0||s.onCheckReadonly()===!0||s.dropDisabled===!0))return l(),null;i(s),d.preventDefault()}),r.addEventListener("dragleave",d=>{d.target===r?o():l()}),r.addEventListener("drop",d=>{try{t.latestDragOverCell&&n.onDropOnCell(t.latestDragOverCell.row,t.latestDragOverCell.col,d)}finally{o()}})}function ht(n=zt){return(r,e)=>Nt(r,e,n)}function Pt(n,r){let e={cell:null};function t(){e.cell=null,r.draggable=!1}function o(l){r.draggable=!0,e.cell=l}r.addEventListener("mousedown",l=>{if(l.button!==0)return;let i=l.target.closest("td");if(!i){t();return}let a=Z(i),d=n.cell(a.row,a.col);n.selectCell(a.row,a.col),d.metaInfo.draggable===!0&&d.metaInfo.object?o(d):t()}),r.addEventListener("dragend",()=>t()),r.addEventListener("dragstart",l=>{if(!l.dataTransfer||!e.cell||!n.onDragStartCell(e.cell,l)){l.preventDefault();return}l.dataTransfer.setDragImage(e.cell.element,10,10)})}function Vr(){return Pt}var Re=class{constructor(r,e){this.undoStack=[];this.redoStack=[];var t;this.commandFilterSet=new Set((t=e.commandFilter)!=null?t:[]),this.options=e,this.grid=r,this.commandMap={UPDATE_CELLS:({cellInfoList:o})=>({undo:()=>{o.forEach(({row:l,col:i,key:a,oldValue:d})=>this.grid.setCell(l,i,{[a]:d}))},redo:()=>{o.forEach(({row:l,col:i,key:a,newValue:d})=>this.grid.setCell(l,i,{[a]:d}))}}),ADD_ROW:({row:o,height:l})=>({undo:()=>this.grid.removeRow(o),redo:()=>this.grid.addRow(l)}),ADD_COLUMN:({col:o,width:l})=>({undo:()=>this.grid.removeColumn(o),redo:()=>this.grid.addColumn(l)}),CHANGE_COL_WIDTH:({col:o,newSize:l,oldSize:i})=>({undo:()=>this.grid.setColumnWidth(o,i),redo:()=>this.grid.setColumnWidth(o,l)}),CHANGE_ROW_HEIGHT:({row:o,newSize:l,oldSize:i})=>({undo:()=>this.grid.setRowHeight(o,i),redo:()=>this.grid.setRowHeight(o,l)})}}get isDisabled(){return this.options.disabled}clearRedoStacks(){this.redoStack.splice(0,this.redoStack.length)}clearUndoStacks(){this.clearRedoStacks(),this.undoStack.splice(0,this.undoStack.length)}pushCommand({type:r,context:e}){if(!this.options.disabled&&!this.commandFilterSet.has(r)){if(this.undoStack.length>=this.options.stackLength&&this.undoStack.splice(0,this.undoStack.length-this.options.stackLength+1),this.clearRedoStacks(),!this.commandMap[r])throw new Error(`Unknown command type ${r}`);this.undoStack.push({type:r,context:e,commandRunner:this.commandMap[r](e)})}}undo(){let r=this.undoStack.pop();if(r)return r.commandRunner.undo(),this.redoStack.push(r),r}redo(){let r=this.redoStack.pop();if(r)return r.commandRunner.redo(),this.undoStack.push(r),r}};var Wt=200;var ft=(n,r)=>(document.createElement("tr").setAttribute("data-row","temp"),{render:()=>{let t=n.scrollBottom+Wt;n.getRowLodash().takeWhile(o=>o.top<=t).filter(o=>!o.isMounted).forEach(o=>o.mount(r))}});var we=1,Bt=20,Ft={stackLength:256,disabled:!0},pt=class extends We{constructor({contextElement:e,colHeader:t,rowHeader:o,body:l,defaultColumnCellFormat:i,plugins:a,undoManagerOptions:d=Ft}){super({contextElement:e});this.totalHeight=0;this.totalWidth=0;this._readonly=!1;this._isScheduledRender=!1;this._scheduledUpdateRowStart=-1;this._copyOptions={rowSpan:!0,colSpan:!0};if(this._rowList=[],this._activeCell=null,this._undoManager=new Re(this,d),this._commandManager=lt(this,this._undoManager),this._cursorManager=be(this),this.defaultColumnCellFormat={all:{editable:!0,text:""}},i)for(let[c,u]of Object.entries(i))this.defaultColumnCellFormat[c]=Object.assign(this.defaultColumnCellFormat[c]||{},u);let s=et();this.colHeader=Object.assign({rowCount:0,colCount:5,cellRenderer:s,defaultSize:100,minSize:80,maxSize:500},t),this.colHeader.minSize=Math.min(this.colHeader.defaultSize,this.colHeader.minSize),this.colHeader.maxSize=Math.max(this.colHeader.defaultSize,this.colHeader.maxSize),this.rowHeader=Object.assign({rowCount:0,colCount:0,cellRenderer:s,defaultSize:30,minSize:30,maxSize:100},o),this.rowHeader.minSize=Math.min(this.rowHeader.defaultSize,this.rowHeader.minSize),this.rowHeader.maxSize=Math.max(this.rowHeader.defaultSize,this.rowHeader.maxSize),this.body=Object.assign({rowCount:5,colCount:0,cellRenderer:s},l),this._headerRows=this.colHeader.rowCount,this._headerColumns=this.rowHeader.colCount,this.contextElement.classList.add(C.grid.blockElementName),this.fixedTopTable=document.createElement("table"),this.bodyTable=document.createElement("table"),this.fixedTopTable.setAttribute("data-type","fixed-top"),this.bodyTable.setAttribute("data-type","body"),this.divWrapper=document.createElement("div"),this.colgroup=document.createElement("colgroup"),this.tbody=document.createElement("tbody"),this.divWrapper.className=C.wrapper.blockElementName,this.fixedTopTable.appendChild(this.colgroup),this.fixedTopTable.appendChild(this.tbody),this.divWrapper.appendChild(this.fixedTopTable),this.contextElement.appendChild(this.divWrapper),this.addGlobalEventListener(this.contextElement,"scroll",c=>{this.scheduleRender(),c.preventDefault()}),this.resizeObserver=new ResizeObserver(()=>this.onResized()),this.resizeObserver.observe(this.contextElement),this.initPlugins(a||[mt(),ut(),ht(),ct({enabledColResizer:!0,enabledRowResizer:!0})]),this.addCoreElement(this.divWrapper),this.mergeManager=it(this),this.virtualRenderer=ft(this,this.tbody),this.clipboardManager=tt(this),this.selector=ee(this),this._emitter=new gt.default({debug:{name:this.uuid}}),rt(this,this._emitter),this.initTableRowCol(),this.fixedTopTable.addEventListener("contextmenu",c=>{let u=c.offsetX,p=c.offsetY,m=c.target;for(;m.tagName!=="TABLE";)u+=m.offsetLeft,p+=m.offsetTop,m=m.parentElement;console.log(p,u,this.findCellOrNull(p,u)),this.onContextMenu(c,this.findCellOrNull(p,u)),c.preventDefault()})}get emitter(){return this._emitter}get fixedRowCount(){return this.colHeader.rowCount}get fixedColumnCount(){return this.rowHeader.colCount}get lastColumnId(){return this.colgroup.children.length-1}get width(){return this.totalWidth}get height(){return this.totalHeight}get fixedRowHeight(){let e=(0,_.default)(this._rowList).takeWhile(t=>t.isFreezed).last();return e?e.bottom:0}get fixedColumnWidth(){return _.default.range(this.rowHeader.colCount).reduce((e,t)=>e+this.getColumnWidth(t),0)}get scrollArea(){return{scrollTop:this.contextElement.scrollTop,scrollLeft:this.contextElement.scrollLeft,scrollHeight:this.contextElement.scrollHeight,scrollWidth:this.contextElement.scrollWidth}}get scrollTop(){return this.contextElement.scrollTop}get scrollLeft(){return this.contextElement.scrollLeft}get scrollBottom(){return this.contextElement.scrollTop+this.contextElement.clientHeight}get scrollRight(){return this.contextElement.scrollLeft+this.contextElement.clientWidth}get minColWidth(){return this.colHeader.minSize}get maxColWidth(){return this.colHeader.maxSize}get minRowHeight(){return this.rowHeader.minSize}get maxRowHeight(){return this.rowHeader.maxSize}get headerRows(){return this._headerRows}get headerColumns(){return this._headerColumns}get headerWidth(){return _.default.range(this.headerColumns).reduce((e,t)=>e+this.getColumnWidth(t),0)}get headerHeight(){return _.default.range(this.headerRows).reduce((e,t)=>e+this.getRowHeight(t),0)}get activeCell(){return this._activeCell}set activeCell(e){var t,o;e!==this.activeCell&&((t=this._activeCell)==null||t.deactivate(),this._activeCell=e,this.activeCell&&this.onSelectCell(this.activeCell),(o=this._activeCell)==null||o.activate())}set readonly(e){this._readonly=e,this._rowList.forEach(t=>{_.default.range(this.getColCount()).forEach(o=>{t.getCell(o).updateReadonlyStatus()})})}addPlugin(e){return e(this,this.fixedTopTable,this.contextElement)}getMergeArea(e,t){let o=this.cell(e,t);if(o.mergeInfo)return{rowSpan:o.mergeInfo.rowSpan,colSpan:o.mergeInfo.colSpan};throw new Error("It's not a based cell!")}isMerged(e,t){return this.mergeManager.isMerged(e,t)}splitCells(e,t){this.mergeManager.splitCells(e,t),this.updateLastSelection()}mergeCells(e,t,o,l){this.mergeManager.mergeCells({top:e,left:t,bottom:o,right:l}),this.updateLastSelection()}findRowOrNull(e){let{scrollTop:t}=this,o=e<t+this.fixedRowHeight?{startIndex:0,endIndex:this.fixedRowCount,curIndex:Math.floor(this.fixedRowCount/2),scrollTop:t}:{startIndex:0,endIndex:this._rowList.length,curIndex:Math.floor(this._rowList.length/2),scrollTop:0},l=this._rowList[o.curIndex];for(;!(e>=o.scrollTop+l.top&&e<=o.scrollTop+l.bottom);){if(e<o.scrollTop+l.top){if(o.endIndex===o.curIndex)return null;o.endIndex=o.curIndex}else{if(o.startIndex===o.curIndex)return null;o.startIndex=o.curIndex}o.curIndex=Math.floor((o.startIndex+o.endIndex)/2),l=this._rowList[o.curIndex]}return l}findCellOrNull(e,t){let o=this.findRowOrNull(e);if(!o)return null;let{scrollLeft:l}=this,i=t<l+this.fixedColumnWidth?{startIndex:0,endIndex:this.fixedColumnCount,curIndex:Math.floor(this.fixedColumnCount/2),scrollLeft:l}:{startIndex:0,endIndex:o.cellCounts,curIndex:Math.floor(o.cellCounts/2),scrollLeft:0},a=this.getColumnLeft(i.curIndex),d=a+this.getColumnWidth(i.curIndex);for(;!(t>=i.scrollLeft+a&&t<=i.scrollLeft+d);){if(t<i.scrollLeft+a){if(i.endIndex===i.curIndex)return null;i.endIndex=i.curIndex}else{if(i.startIndex===i.curIndex)return null;i.startIndex=i.curIndex}i.curIndex=Math.floor((i.startIndex+i.endIndex)/2),a=this.getColumnLeft(i.curIndex),d=a+this.getColumnWidth(i.curIndex)}let s=o.getCell(i.curIndex);return s.mergeMain?s.mergeMain:s}getBaseCell(e,t){let o=this.cell(e,t);if(o.isMerged)return{row:o.row,col:o.col};if(o.mergeMain)return{row:o.mergeMain.row,col:o.mergeMain.col};throw new Error("It's not a merged cell!")}releaseCells(){this.lastSelection&&(this.selector.releaseCells(this.lastSelection),this.lastSelection=void 0,this.activeCell=null)}clearRows(){this.headerRows<this.getRowCount()&&this.removeRows(this.headerRows,this.getRowCount()-1),this.scheduleRender()}getColumnLeft(e){return _.default.range(e).filter(t=>this.getColumnVisible(t)).reduce((t,o)=>t+this.getColumnWidth(o),0)}selectRange(e,t,o,l,i){return this.releaseCells(),this.lastSelection=this.selector.selectRange({top:e,left:t,bottom:o,right:l}),this.onSelectChanged(this.lastSelection),this.activeCell=i!=null?i:this.cell(e,t),this.lastSelection}selectAll(){return this.selectRange(this.headerRows,this.headerColumns,this.getRowCount()-1,this.getColCount()-1,this.activeCell||void 0)}getCellWidth(e){return e.mergeInfo?_.default.range(e.mergeInfo.colSpan).filter(t=>this.getColumnVisible(e.col+t)).reduce((t,o)=>t+this.getColumnWidth(e.col+o),0):this.getColumnWidth(e.col)}getCellHeight(e){return e.mergeInfo?_.default.range(e.mergeInfo.rowSpan).filter(t=>this.getRowVisible(e.row+t)).reduce((t,o)=>t+this.getRowHeight(e.row+o),0):this.getRowHeight(e.col)}getSelection(){return _.default.clone(this.lastSelection)}scrollOnRow(e){let t=this.getRow(e),o=t.top,l=t.top+t.height,{scrollBottom:i,fixedRowHeight:a,scrollTop:d}=this,s=d+a;i<l?this.contextElement.scrollTop=d+(l-i):s>o&&(this.contextElement.scrollTop=o-a)}scrollOnCol(e){let t=this.getColumnLeft(e),o=t+this.getColumnWidth(e),{fixedColumnWidth:l,scrollRight:i,scrollLeft:a}=this,d=a+l;i<o?this.contextElement.scrollLeft=a+(o-i):d>t&&(this.contextElement.scrollLeft=t-l)}resetScroll(){this.contextElement.scrollTop=0,this.contextElement.scrollLeft=0}scrollInView(e,t){this.scrollOnRow(e),this.scrollOnCol(t)}focus(){this.contextElement.dispatchEvent(new Event("focus"))}setText(e,t,o){this.setCell(e,t,{text:Number.isInteger(o)?o.toString():`${o||""}`})}getText(e,t){return this.cell(e,t).text}getValue(e,t){return this.cell(e,t).value}getColumnWidth(e){return parseInt(this.colgroup.children[e].style.width||"0")}setColumnWidth(e,t){let o=this.getColElement(e);if(!o)throw new Error(`Not found column at ${e}`);this.totalWidth-=this.getColumnWidth(e);let l=O(t,this.colHeader.minSize,this.colHeader.maxSize);this.setTableWidth(this.totalWidth+l),o.style.width=`${l}px`,e<this.getFreezedColumnCount()&&((0,_.default)(this._rowList).take(this.getFreezedRowCount()).forEach(i=>this.updateRowLeft(i)),this.updateCurrentScrollBodyRowsLeft()),this._emitter.emit("onColumnResized",{col:e}),this.generateScrollBar(),this.onResizeColumn(e)}getRowHeight(e){if(this._rowList[e])return this._rowList[e].height;throw new Error(`Not found column at ${e}`)}setRowHeight(e,t){if(!this._rowList[e])throw new Error(`Not found row at ${e}`);let o=this._rowList[e];o.height=O(t,this.rowHeader.minSize,this.rowHeader.maxSize),this.updateRowsTopFrom(e)}setRowTextColor(e,t){if(!this._rowList[e])throw new Error(`Not found column at ${e}`);this._rowList[e].textColor=t}getObject(e,t){if(this.cell(e,t))return this.cell(e,t).object;throw new Error(`Not found cell ${e}, ${t}`)}setObject(e,t,o){if(this.cell(e,t))this.setCell(e,t,{object:o});else throw new Error(`Not found cell ${e}, ${t}`)}cell(e,t){return this.getRow(e).getCell(t)}isBased(e,t){return this.cell(e,t).mergeMain===void 0}getCell(e,t){return this.getRow(e).getCell(t).metaInfo}setCell(e,t,o){if(!this.cell(e,t))throw new Error(`Not found cell ${e}, ${t}`);this.cell(e,t).cellInfo=o}selectCell(e,t){this.selectRange(e,t,e,t,this.cell(e,t))}getRowCount(){return this._rowList.length}getColCount(){return this.colgroup.children.length}getFreezedRowCount(){return this.colHeader.rowCount}getFreezedColumnCount(){return this.rowHeader.colCount}getRow(e){return this._rowList[e]}getRowLodash(){return(0,_.default)(this._rowList)}addRow(e=this.rowHeader.defaultSize){let t=this._rowList.length,o=this.createIRGridRow(t,this.totalHeight,e);return this._rowList.push(o),this.onResized(),t}removeRow(e){return this.removeRows(e,e)}removeColumn(e){return this.removeColumns(e,e)}removeRows(e,t){if(e<this.headerRows)throw new Error("Could not remove rows at header!");if(t>this.getRowCount())throw new Error(`Out of index. maximum bottom values is ${this.getRowCount()}. If you wanna clear all rows, please call clearRows()`);if(this.mergeManager.checkConflictingInRows(e,t))return!1;_.default.range(e,t+1).forEach(i=>{let a=this._rowList[i];a.unmount(),this.setTableHeight(this.totalHeight-(a.height+we));for(let d of a.getCellGenerator())d.isMerged&&this.mergeManager.removeMergeCell(d.row,d.col)});let o=1+t-e,l=this.getRow(e).top;if(this._rowList.splice(e,o),e<this.getRowCount()){this.getRow(e).top=l;let i=e;for(this.updateRowsTopFrom(e);this._rowList[i];)this._rowList[i].rowId-=o,++i}return this.onResized(),!0}removeColumns(e,t){if(e<this.rowHeader.colCount)throw new Error(`The col num that you wanna remove must be less then '${this.rowHeader.colCount}'! (Row Header Columns)`);if(t>this.getColCount())throw new Error(`Out of index. maximum bottom values is ${this.getColCount()}`);return this.mergeManager.checkConflictingInColumns(e,t)?!1:((0,_.default)(this._rowList).forEach(o=>{for(let l of o.getCellGenerator(e,t))l.isMerged&&this.mergeManager.removeMergeCell(l.row,l.col);o.removeCells(e,t)}),_.default.range(e,t+1).forEach(()=>{this.setTableWidth(this.totalWidth-this.getColumnWidth(e)),this.colgroup.removeChild(this.colgroup.children[e])}),this.onResized(),!0)}addColumn(e=this.colHeader.defaultSize){let t=this.addColGroup(e);return(0,_.default)(this._rowList).forEach(o=>o.addCell(this.createIRGridCell(o.rowId,t))),++this.colHeader.colCount,this.onResized(),t}insertRow(e,t){return this.insertRows(e,1,t)}insertRows(e,t,o){if(e<this.headerRows)throw new Error("Could not insert rows in column header");if(!this.mergeManager.checkCanInsertRow(e))return!1;let l=o||this.rowHeader.defaultSize,i=[],a=l*i.length+i.length,d=this._rowList[e],s=_.default.cloneDeep(this.lastSelection);return this.releaseCells(),_.default.range(t).forEach(c=>i.push(this.createIRGridRow(e+c,d.top,l))),_.default.range(e,this._rowList.length).forEach(c=>{this._rowList[c].rowId+=t,this._rowList[c].top+=a+we}),this._rowList.splice(e,0,...i),this.updateRowsTopFrom(e),d.isMounted&&i.forEach(c=>c.mount(this.tbody,d.element)),s&&this.selectRange(s.top,s.left,s.bottom,s.right),this.onResized(),!0}insertColumn(e,t){return this.insertColumns(e,1,t)}insertColumns(e,t,o=this.colHeader.defaultSize){if(e<this.headerColumns)throw new Error("Could not insert rows in row header");if(!this.mergeManager.checkCanInsertColumn(e))return!1;let l=_.default.cloneDeep(this.lastSelection);return _.default.range(t).forEach(()=>{this.createColElement(e),this.colgroup.children[e].style.width=`${o}px`,this.setTableWidth(this.width+o)}),this.releaseCells(),this._rowList.forEach(i=>{let a=[];_.default.range(t).forEach(d=>a.push(this.createIRGridCell(i.rowId,e+d))),i.insertCells(a,e)}),l&&this.selectRange(l.top,l.left,l.bottom,l.right),this.onResized(),!0}autoSizeColumn(e){this.autoSizeColumns(e,e)}autoSizeColumns(e,t){_.default.range(e,t+1).reduce((l,i)=>{let a=(0,_.default)(this._rowList).map(s=>s.getCell(i)).filter(s=>s.visible&&s.mergeInfo.colSpan===1).flatMap(s=>s.innerWidth).reduce((s,c)=>Math.max(s,c),0),d=a!==this.getColumnWidth(i);return d&&this.setColumnWidth(i,O(Math.ceil(a+Bt),this.colHeader.minSize,this.colHeader.maxSize)),l||d},!1)&&this.onResized()}autoSizeRow(e){this.autoSizeRows(e,e)}autoSizeRows(e,t){_.default.range(e,t+1).reduce((l,i)=>{let a=this._rowList[i].setAutoHeight(this.rowHeader.minSize,this.rowHeader.maxSize);return l||a},!1)&&(this.updateRowsTopFrom(e),this.onResized())}copyToClipboard(){ze.setText(this.clipboardManager.getSelectedText())}undo(){if(this._undoManager.isDisabled)return;let e=this._undoManager.undo();e?this.onUndo(e):console.warn("No undo command in stack.")}redo(){if(this._undoManager.isDisabled)return;let e=this._undoManager.redo();e?this.onRedo(e):console.warn("No redo command in stack.")}paste(e,t=[]){let o=this.getSelection();if(!o)return;let l=this.clipboardManager.convertText(e);if(l.length===0)return;let{top:i,left:a}=o,d=Math.max(i+l.length-1,o.bottom),s=Math.max(a+l[0].length-1,o.right),c={top:i,left:a,bottom:d,right:s},u=[],p={height:l.length,width:l[0].length};for(let{y:m,x:M}of Ne(c.bottom-c.top+1,c.right-c.left+1)){let[y,G]=[m+i,M+a];if(!this.hasRow(y)&&this.onAutoInsertRow(y)&&this.addRow(),!this.hasColumn(G)&&this.onAutoInsertColumn(G)&&this.addColumn(),this.hasRow(y)&&this.hasColumn(G)){let T=this.cell(y,G),k=l[m%p.height][M%p.width];T.visible&&T.onCheckReadonly()!==!0&&T.metaInfo.disabled!==!0&&T.metaInfo.clipboardEnabled!==!1&&this.onClipboardBeforePasteCell(T,k)&&u.push({row:y,col:G,text:k})}}u.length!==0&&(this.onClipboardBeforePaste(c),u.forEach(({text:m,row:M,col:y},G)=>{let T=this.cell(M,y),k=t[G];if(T.text=m,!(!T.visible||!k)){if(k.rowSpan>1||k.colSpan>1){let A={top:M,bottom:M+k.rowSpan-1,left:y,right:y+k.colSpan-1};this.mergeManager.isValidatedMerging(A)?this.mergeManager.mergeCells(A):console.warn(`Occurred an error for merging cells when pasting! ${M}, ${y}`)}k.refCellText&&(T.text=k.refCellText),this.onClipboardAfterPasteCell(T)}}),this.onClipboardAfterPaste(c),this.selectRange(c.top,c.left,c.bottom,c.right))}hasRow(e){return e<this.getRowCount()}hasColumn(e){return e<this.getColCount()}setRowVisible(e,t){return this.mergeManager.checkConflictingInRows(e,e)?!1:(t===this.getRowVisible(e)||(this._rowList[e].visible=t,this.setTableHeight(this.totalHeight+(t?this.getRowHeight(e):-this.getRowHeight(e))),this.updateRowsTopFrom(e),this.scheduleRender()),!0)}getRowVisible(e){return this._rowList[e].visible}setColumnVisible(e,t){return this.mergeManager.checkConflictingInColumns(e,e)||t===this.getColumnVisible(e)?!1:(this._rowList.forEach(o=>o.setColumnVisible(e,t)),this.colgroup.children[e].style.display=t?"":"none",this.setTableWidth(this.totalWidth+(t?this.getColumnWidth(e):-this.getColumnWidth(e))),this.updateCurrentScrollBodyRowsLeft(),!0)}getColumnVisible(e){return this.colgroup.children[e].style.display!=="none"}createFinder(e={}){return nt(this,e)}selectColumn(e){this.selectColumns(e,e)}selectColumns(e,t){e<this.headerColumns||this.headerRows<this.getRowCount()&&this.selectRange(this.headerRows,e,this.getRowCount()-1,t,this.cell(this.headerRows,e))}selectRow(e){this.selectRows(e,e)}selectRows(e,t){e<this.headerRows||this.selectRange(e,this.headerColumns,t,this.getColCount()-1,this.cell(e,this.headerColumns))}freezeRows(e){let{headerRows:t}=this;this.colHeader.rowCount=e+t,(0,_.default)(this._rowList).drop(this.headerRows).takeWhile(l=>l.isFreezed).forEach(l=>{l.unfreeze(),l.unmount()});let o=_.default.range(t).reduce(l=>l==null?void 0:l.nextElementSibling,this.tbody.firstElementChild);(0,_.default)(this._rowList).drop(t).take(e).forEach(l=>{l.freeze(),l.mount(this.tbody,o)})}freezeColumns(e){this.rowHeader.colCount=e+1,(0,_.default)(this._rowList).forEach(t=>t.setStickyHeader(this.rowHeader.colCount)),this.updateCurrentScrollBodyRowsLeft()}clearUndoStack(){this._undoManager.clearUndoStacks()}setClipboardOptions(e){Object.assign(this._copyOptions,e)}doCommand(e,t){return this._commandManager.doCommand(e,t)}sort(e,t){let o=this._rowList.slice(this.headerRows),l=this.height;this.releaseCells(),o.sort((i,a)=>t==="ASC"?e(i,a):-e(i,a)),this.clearRows(),o.reduce((i,a)=>(a.top=i.top,a.rowId=i.id,i.top+=a.height,++i.id,i),{id:this.headerRows,top:this.fixedRowHeight}),this._rowList.push(...o),this.setTableHeight(l),this.virtualRenderer.render()}onSelectCell(e){}onResizeContext(){}onResizeColumn(e){}onEditCellDone(e,t,o,l,i,a){}onSelectChanged(e){}onClearCell(e){}onColumnClick(e){this.selectColumn(e.col)}onRowClick(e){this.selectRow(e.row)}onCreatingCell(e){}onCellRightClick(e,t){}onEditKeyDown(e,t,o,l){}onMountedRow(e){}onClipboardBeforePasteCell(e,t){return!0}onClipboardBeforePaste(e){}onClipboardAfterPasteCell(e){}onClipboardAfterPaste(e){}onAutoInsertRow(e){return!0}onAutoInsertColumn(e){return!0}onDoubleClickCell(e){e.doEditMode()}onDropOnCell(e,t,o){}onDragStartCell(e,t){return!t.dataTransfer||!e.metaInfo.object?!1:(t.dataTransfer.setData("application/json",JSON.stringify(e.metaInfo.object)),!0)}onNativePaste(e){if(!e.clipboardData)throw new Error("Invalid ClipboardEvent");if(this.activeCell==null)throw new Error("No active call when pasting");let t=e.clipboardData.getData("text/plain")||"",o=e.clipboardData.getData("ir-grid/merge-cells")||"";o?this.paste(t,JSON.parse(o)):this.paste(t,[]),e.preventDefault(),e.stopPropagation()}onNativeCut(e){let t=this.getSelection();if(!t)throw new Error("Detected copy without selection");this.onNativeCopy(e);let o=W(this);for(let l of o.getSelectionGenerator(t))l.editable&&l.clear()}onGetCopyInfo(e){return{refCellText:e.mergeMain?e.mergeMain.text:void 0,rowSpan:this._copyOptions.rowSpan?e.mergeInfo.rowSpan:1,colSpan:this._copyOptions.colSpan?e.mergeInfo.colSpan:1}}onNativeCopy(e){if(!e.clipboardData)throw new Error("Invalid ClipboardEvent");let t=this.getSelection();if(!t)throw new Error("Detected copy without selection");let o=this.clipboardManager.getSelectedText(),l=W(this),i=[];for(let a of l.getSelectionGenerator(t))i.push(this.onGetCopyInfo(a));e.clipboardData.setData("ir-grid/merge-cells",JSON.stringify(i)),e.clipboardData.setData("text/plain",o),this.focus(),this.onCopy(),e.preventDefault(),e.stopPropagation()}onCopy(){}onUndo(e){}onRedo(e){}onContextMenu(e,t){}onInnerDoneCellEdit(e,t,o){!t||this.doCommand("DONE_CELL_EDIT",{row:e.row,col:e.col,text:e.text,beforeText:o})}onCheckCellReadonly(e){return this._readonly?!0:e.metaInfo.readonly===!0}initPlugins(e){try{for(let t of e)t(this,this.fixedTopTable,this.contextElement)}catch(t){console.error("Plugin init error",t)}}initTableRowCol(){_.default.range(this.colHeader.colCount).forEach(()=>this.addColGroup(this.colHeader.defaultSize)),_.default.range(this.colHeader.rowCount).forEach(()=>{let e=this.getRow(this.addRow());e.mount(this.tbody),e.freezeHeader()}),_.default.range(this.body.rowCount).forEach(()=>this.addRow())}updateLastSectionProperly(){if(this.lastSelection){let e=this.getRowCount()-1,t=this.getColCount()-1;if(this.lastSelection.top>e||this.lastSelection.left>t){this.releaseCells();return}this.selectRange(Math.min(this.lastSelection.top,e),Math.min(this.lastSelection.left,t),Math.min(this.lastSelection.bottom,e),Math.min(this.lastSelection.right,t))}}updateLastSelection(){this.lastSelection&&this.selectRange(this.lastSelection.top,this.lastSelection.left,this.lastSelection.bottom,this.lastSelection.right)}createColElement(e){let t=document.createElement("col");return e?this.colgroup.children[e].insertAdjacentElement("beforebegin",t):this.colgroup.appendChild(t),t}addColGroup(e){let t=this.colgroup.children.length;return this.createColElement(),this.setColumnWidth(t,e),t}updateCurrentScrollBodyRowsLeft(){let e=this.contextElement.scrollTop-this.contextElement.scrollHeight,{scrollBottom:t}=this;(0,_.default)(this._rowList).take(this.getFreezedRowCount()).forEach(o=>this.updateRowLeft(o)),(0,_.default)(this._rowList).drop(this.getFreezedRowCount()).filter(o=>o.top>=e&&o.top<=t).forEach(o=>this.updateRowLeft(o))}initColumnHeaderCell(e){e.cellType="col-header",e.onClick=()=>this.onColumnClick(e)}initRowHeaderCell(e){e.cellType="row-header",e.onClick=()=>this.onRowClick(e)}initBodyCell(e){e.cellType="body-cell",e.onMoveLeftOnEdit=()=>this._cursorManager.selectNextSelection(0,-1,!1),e.onMoveUpOnEdit=()=>this._cursorManager.selectNextSelection(-1,0,!1),e.onMoveRightOnEdit=()=>this._cursorManager.selectNextSelection(0,1,!1),e.onMoveDownOnEdit=()=>this._cursorManager.selectNextSelection(1,0,!1),e.onTabOnEdit=(t,o)=>{o?this._cursorManager.selectBeforeActiveCell():this._cursorManager.selectNextActiveCell()},e.onEnterOnEdit=()=>{let t=this._cursorManager.getNextYBelow(e.row,e.col,1);e.row!==t&&setTimeout(()=>{this.selectCell(t,e.col),this.cell(t,e.col).doEditMode()},0)},e.onClear=()=>this.onClearCell(e),e.onDblClick=()=>this.onDoubleClickCell(e),e.onEditDone=(t,o,l,i,a,d)=>{this.activeCell===t&&this.selectCell(t.row,t.col),this.onEditCellDone(t,o,l,i,a,d),this.onInnerDoneCellEdit(t,o,l),this.focus()},e.onEditKeyDown=(t,o,l,i)=>this.onEditKeyDown(t,o,l,i)}createIRGridCell(e,t){let o=e<this.headerRows,l=!o&&t<this.headerColumns,i=o||l?"th":"td",a=o?this.colHeader.cellRenderer:l?this.rowHeader.cellRenderer:this.body.cellRenderer,d=new Ce({row:e,col:t,tag:i,cellRenderer:a,metaInfo:Ae(j(j({},this.defaultColumnCellFormat.all),this.defaultColumnCellFormat[t]),{emitter:this._emitter})});switch(d.onRightClick=(s,c)=>this.onCellRightClick(s,c),d.onCheckReadonly=()=>this.onCheckCellReadonly(d),!0){case o:this.initColumnHeaderCell(d);break;case l:this.initRowHeaderCell(d);break;default:this.initBodyCell(d);break}return this.onCreatingCell(d),d}updateRowLeft(e){_.default.range(this.getFreezedColumnCount()).filter(t=>this.getColumnVisible(t)).reduce((t,o)=>(e.setCellLeft(o,t),t+this.getColumnWidth(o)),0)}updateRowsTopFrom(e){this._scheduledUpdateRowStart!==-1&&this._scheduledUpdateRowStart>e?this._scheduledUpdateRowStart=e:this._scheduledUpdateRowStart===-1&&(this._scheduledUpdateRowStart=e,setTimeout(()=>{let t=this._rowList[this._scheduledUpdateRowStart],o=(0,_.default)(this._rowList).drop(this._scheduledUpdateRowStart).filter(l=>l.visible).reduce((l,i)=>(i.top=l,l+i.height+we),t.top);this.setTableHeight(o),this._scheduledUpdateRowStart=-1},0))}getColElement(e){return this.colgroup.children[e]}setTableWidth(e){this.totalWidth=e,this.divWrapper.style.width=`${this.totalWidth}px`}setTableHeight(e){this.totalHeight=e,this.divWrapper.style.height=`${this.totalHeight}px`}onResized(){this.updateLastSectionProperly(),this._emitter.emit("onContextResized"),this.onResizeContext(),this.scheduleRender()}createIRGridRow(e,t,o){let l=new ge({row:e,height:o,top:t,rowType:e<this.headerRows?"col-header":"body"});return _.default.range(this.getColCount()).forEach(i=>l.addCell(this.createIRGridCell(e,i))),_.default.range(this.getColCount()).filter(i=>this.getColumnVisible(i)===!1).forEach(i=>l.setColumnVisible(i,!1)),l.onMounted=()=>{l.setStickyHeader(this.rowHeader.colCount),this.onMountedRow(l.rowId)},l.onChangedHeight=()=>{_.default.range(this.getColCount()).forEach(i=>{let a=l.getCell(i),d=a.mergeMain?a.mergeMain:a.mergeInfo.rowSpan>1?a:null;d&&(d.height=this.mergeManager.getMergedRowHeight(d.row,d.row+d.mergeInfo.rowSpan-1))})},this.setTableHeight(this.totalHeight+o+we),l}scheduleRender(){this._isScheduledRender||(this._isScheduledRender=!0,requestAnimationFrame(()=>{this.updateCurrentScrollBodyRowsLeft(),this.generateScrollBar(),this.virtualRenderer.render(),this._isScheduledRender=!1}))}};var Kt=16,Ut=6,$t=6*2,Wo=({onCheckboxClick:n})=>{let r=(e,t)=>{let o=z(e.style.fontSize,e.style.fontFamily),l=t.label?Ut+o.calculateWidth(t.label):0;return Kt+$t+l};return(e,t,o)=>{let l=document.createElement("div"),i=document.createElement("label"),a=document.createElement("input");if(o.cellType="checkbox",o.editable=!1,o.onCalculateWidth=r,l.className=oe.checkbox.blockElementName,i.className=oe.checkboxWrapper.blockElementName,a.type="checkbox",a.className=oe.checkboxInput.blockElementName,i.appendChild(a),o.label){let d=document.createElement("span");d.className=oe.text.blockElementName,d.innerText=o.label,i.appendChild(d)}return l.appendChild(i),a.checked=o.text==="true",i.onkeydown=d=>d.preventDefault(),a.onchange=()=>{o.text=a.checked?"true":"false",o.emitter.emit("onCellInfoChanged",{row:e,col:t}),n&&n(e,t,a.checked)},l}};var Vt=30,Xo=({items:n,onChange:r})=>{let{divDropdown:e,ulItems:t}=Fe(),o=[],l,i,a=null;for(let{value:s,text:c}of n){let{item:u,button:p}=Ke(s,c);o.push({value:s,text:c,buttonElement:p,itemWrapperElement:u}),t.appendChild(u)}let d=(s,c)=>{let u=z(s.style.fontSize,s.style.fontFamily),p=n.reduce((m,M)=>Math.max(m,u.calculateWidth(M.text)),0);return Vt+p};return(s,c,u)=>{let p=document.createElement("div"),m=document.createElement("input"),M=document.createElement("i");u.cellType="select",u.editable=!1,u.onCalculateWidth=d,p.classList.add(C.cell.select,F.select.blockElementName,F.selectInput.blockElementName),m.classList.add(F.selectInputNative.blockElementName),M.classList.add(F.selectInputIcon.blockElementName,"ir-icon","ir-icon--chevron-down"),m.type="text",m.readOnly=!0,o.filter(A=>A.text===u.text).forEach(A=>{m.value=A.text,u.value=A.value});let y=Oe({eventElements:[p,e],clickOutsideFunc:()=>G.hide()}),G={show:()=>{a=Be(p,e,{placement:"bottom-end",modifiers:[{name:"offset",options:{offset:[0,8]}}]}),T.create(),y.create(),l=u.value,i=u.text;for(let{value:A,text:N,itemWrapperElement:P,buttonElement:re}of o)N===u.text?P.classList.add("is-selected"):P.classList.remove("is-selected"),re.onclick=()=>{u.text=N,u.value=A,m.value=N,u.emitter.emit("onCellInfoChanged",{row:s,col:c}),u.emitter.emit("updateCellStatus",{row:s,col:c}),r==null||r.call(null,s,c,A,N,l,i),G.hide()};e.style.width=`${p.offsetWidth}px`,e.setAttribute("data-row",s.toString()),e.setAttribute("data-col",c.toString()),document.body.appendChild(e),p.classList.add(F.select["is-expanded"]),requestAnimationFrame(()=>{e.classList.add(F.select["is-expanded"])})},hide:()=>{T.destroy(),y.destroy(),p.classList.remove(F.select["is-expanded"]),e.classList.remove(F.select["is-expanded"]),e.addEventListener("transitionend",()=>{e.getAttribute("data-row")===s.toString()&&e.getAttribute("data-col")===c.toString()&&(a==null||a.destroy(),e.remove())},{once:!0})}},T=De(G),k=()=>{p.classList.contains(F.select["is-expanded"])?G.hide():G.show()};return p.onclick=()=>k(),p.appendChild(m),p.appendChild(M),p}};var ae=B(wt());var jt=24,on=({onDateClick:n,format:r=Ue.datePicker.dateFormat,minDate:e=new Date(0),maxDate:t=new Date("9999-12-31")})=>{let o=(l,i)=>z(l.style.fontSize,l.style.fontFamily).calculateWidth(i.text||r)+jt;return(l,i,a)=>{let d=document.createElement("div"),s=document.createElement("input"),c=document.createElement("button"),u=document.createElement("i");if(a.cellType="datePicker",a.onCalculateWidth=o,s.readOnly=!0,s.maxLength=r.length,d.classList.add(de.input.blockElementName,C.cell["date-picker"]),s.classList.add(de.inputNative.blockElementName),c.classList.add(de.inputSuffix.blockElementName),u.classList.add("ir-icon","ir-icon--calendar"),s.type="text",s.placeholder=r,(0,ae.default)(a.text,r,!0).isValid()===!1)a.text="";else{let m=(0,ae.default)(a.text,r);(m.isBefore(e)||m.isAfter(t))&&(a.text="")}s.value=a.text||"",c.appendChild(u),d.appendChild(s),d.appendChild(c);let p=$e({uuid:Pe(),refElement:d,minDate:e,maxDate:t,onClick:m=>{let M=(0,ae.default)(m).format(r);s.value=M,a.text=M,n==null||n.call(null,l,i,M),a.emitter.emit("onCellInfoChanged",{row:l,col:i}),p.hide()}});return c.onclick=()=>{if(!p.visible){let m=(0,ae.default)(a.text,r,!0);m.isValid()?p.update(m.toDate(),m.toDate()):p.update(new Date,null),p.show()}},d}};var Ct="progress",te={progress:v({block:Ct,modifier:["danger","warning","info","tertiary","secondary"]}),bar:v({block:Ct,element:"bar"}),VALUE_PROPERTY:"--progress-value",PERCENT_PROPERTY:"--progress-percent"};var Yt=24,un=({min:n=0,max:r=100,defaultIntent:e,afterDecimalLen:t=2})=>(o,l,i)=>{var p;let a=document.createElement("div"),d=document.createElement("div");a.className=C.cellProgress.blockElementName,d.className=te.progress.blockElementName;let s=(p=i.intent)!=null?p:e;s&&d.classList.add(te.progress[s]),i.cellType="progress",i.editable=!1,i.onCalculateWidth=m=>z(m.style.fontSize,m.style.fontFamily).calculateWidth(d.style.getPropertyValue(te.VALUE_PROPERTY))+Yt;let u=(O(parseFloat(i.text||"0"),n,r)-n)/r*100;return d.style.setProperty(te.VALUE_PROPERTY,`'${u.toFixed(t)}%'`),d.style.setProperty(te.PERCENT_PROPERTY,`${u}%`),a.appendChild(d),a};var Xt=14,Zt=26,gn=({onClick:n,defaultColor:r="transparent",defaultLabel:e,defaultIcon:t})=>{let o=(l,i)=>{let a=z(l.style.fontSize,l.style.fontFamily),d=i.icon||t,s=i.label||e,c=a.calculateWidth(s||"")+(d?Zt:0);return Xt+c};return(l,i,a)=>{var m,M;let d=document.createElement("div"),s=document.createElement("button");d.className=C.cell.button,a.editable=!1,a.onCalculateHeight=()=>24,a.onCalculateWidth=o,s.className=ue.button.blockElementName;let c=(m=a.intent)!=null?m:r;c&&s.classList.add(ue.button[c]),n&&(s.onclick=y=>n(y,l,i));let u=a.icon||t,p=((M=a.label)!=null?M:e)||"";if(u){let y=document.createElement("i"),G=document.createElement("span");y.classList.add(ue.buttonIcon.blockElementName,"ir-icon",`ir-icon--${u}`),G.innerText=p,s.appendChild(y),s.appendChild(G)}else s.innerText=p;return d.appendChild(s),d}};var Ie="radio",ce={radio:v({block:Ie}),radioWrapper:v({block:Ie,element:"wrapper"}),radioInput:v({block:Ie,element:"input"}),text:v({block:Ie,element:"text"})};var qt=16,Jt=6,Qt=6*2,En=({onRadioClick:n})=>{let r=null,e=(o,l)=>{let i=z(o.style.fontSize,o.style.fontFamily),a=l.label?Jt+i.calculateWidth(l.label):0;return qt+Qt+a},t=o=>{r&&!(o.col===r.col&&o.row===r.row)&&(r.radio.checked=!1,r.data.text="false",r.data.emitter.emit("onCellInfoChanged",{row:o.row,col:o.col})),r=o};return(o,l,i)=>{let a=document.createElement("div"),d=document.createElement("label"),s=document.createElement("input");if(i.cellType="radio",i.editable=!1,i.onCalculateWidth=e,a.className=ce.radio.blockElementName,d.className=ce.radioWrapper.blockElementName,s.type="radio",s.className=ce.radioInput.blockElementName,d.appendChild(s),i.label){let c=document.createElement("span");c.className=ce.text.blockElementName,c.innerText=i.label,d.appendChild(c)}return a.appendChild(d),s.checked=i.text==="true",s.checked===!0&&t({radio:s,data:i,row:o,col:l}),d.onkeydown=c=>c.preventDefault(),s.onclick=()=>{t({radio:s,data:i,row:o,col:l}),i.text="true",i.emitter.emit("onCellInfoChanged",{row:o,col:l}),n&&n(o,l)},a}};var bt=n=>n===""||!n?-Number.MAX_SAFE_INTEGER:parseInt(n,10),Ln=n=>{let r=new Set,e=null,t=!0;return{set enabledColumnClick(o){t=o},clearNumberColumns(){r.clear()},clearSortOrder(){e&&(e.cellInfo={sortOrder:void 0}),e=null},removeNumberColumns(...o){o.forEach(l=>r.delete(l))},setNumberColumns(...o){o.forEach(l=>r.add(l))},compareTo(o,l){let i=r.has(o.col)?bt(o.text):o.text,a=r.has(l.col)?bt(l.text):l.text;return i<a?-1:i>a?1:0},overrideColumnClickEvent(){console.debug(`Overrode IRGrid Column Sort Manager target-uuid::${n.uuid}`),n.onColumnClick=o=>{!t||this.toggleSortColumn(o)}},sortColumn(o,l){n.sort((i,a)=>this.compareTo(i.getCell(o),a.getCell(o)),l)},toggleSortColumn(o){if(o.cellType!=="col-header")throw new Error("Can only execute in col-header");let l=o.cellInfo.sortOrder==="ASC"?"DESC":"ASC";e!==o&&this.clearSortOrder(),e=o,o.cellInfo={sortOrder:l},this.sortColumn(o.col,l)}}};export{ht as CellDropPlugin,Fr as CellObserverPlugin,Wr as ColumnFillPlugin,mt as DefaultKeyPlugin,pt as IRGrid,ut as MouseCellSelectorPlugin,ct as ResizerPlugin,Nr as RowSelectionPlugin,Vr as SingleCellDragPlugin,Ln as createIRGridColumnSortManager,gn as renderGridButton,et as renderGridCellDefault,ur as renderGridCellIconButton,Wo as renderGridCheckbox,on as renderGridDatePicker,un as renderGridProgress,En as renderGridRadio,Xo as renderGridSelect,mr as renderRowNoHeaderCell};
//# sourceMappingURL=grid.js.map
